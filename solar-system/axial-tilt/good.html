<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="../../utils/three.js"></script>
  <script src="../../utils/orbitControls.js"></script>
  <script src="../../utils/resize.js"></script>
  <title>自转轴正确演示</title>
  <link rel="stylesheet" href="../style/style.css">
</head>

<body>
  <script>
    var _width = window.innerWidth
    var _height = window.innerHeight
    var fov = 50
    var aspect = _width / _height
    var near = 1
    var far = 2000
    var camera, scene, renderer
    var controls
    var ambitLight, light
    var planet,

    earthTexture = THREE.ImageUtils.loadTexture('../image/earth.jpg', {}, function() {
      renderer.render(scene, camera);
    })
    earthMaterial = new THREE.MeshLambertMaterial({
      map: earthTexture
    })

    function init() {
      camera = new THREE.PerspectiveCamera(fov, aspect, near, far)
      camera.position.set(0, 0, 200)
      scene = new THREE.Scene()
      renderer = new THREE.WebGLRenderer({
        alpha: false,
        antialias: true
      })
      renderer.setSize(_width, _height)
      renderer.shadowMap.enabled = true
      document.body.appendChild(renderer.domElement)

      ambitLight = new THREE.AmbientLight(0xffffff, .2)
      light = new THREE.DirectionalLight(0xffffff, 1.2)
      light.position.set(20, 10, 20)
      light.castShadow = true
      light.shadow.camera.left = -400
      light.shadow.camera.right = 400
      light.shadow.camera.top = 400
      light.shadow.camera.bottom = -400
      light.shadow.camera.near = 1
      light.shadow.camera.far = 1000
      light.shadow.mapSize.width = 2048
      light.shadow.mapSize.height = 2048


      scene.add(light)
      scene.add(ambitLight)
      planet = new Planet()
      scene.add(planet.mesh)
      controls = new THREE.OrbitControls(camera, renderer.domElement)
      loop()
    }

    function loop() {
      planet.sphere.rotation.y += 0.03
      renderer.render(scene, camera)
      requestAnimationFrame(loop)
    }

    var Planet = function() {
      this.mesh = new THREE.Object3D()
      var geom = new THREE.SphereGeometry(30, 30, 30)

      this.sphere = new THREE.Mesh(geom, earthMaterial)
      this.mesh.add(this.sphere)
      this.mesh.rotation.z = Math.PI * 40 / 180
    }
    init()
  </script>
</body>

</html>
